**n-upla =** riga di una tabella

Dentro le nostre tabelle abbiamo gli attributi, esistono molteplici attributi speciali tra cui:
- **Chiave primaria**: attributo not null, ogni riga contiene una chiave univoca (nelle rappresentazioni grafiche è una linea continua sotto il nome della colonna)
- **Chiave esterna**: il riferimento ad una chiave primaria di una tabella esterna (potrebbe anche non essere not null, nelle grafiche si usa una linea trattegiata sotto il nome della colonna)
$R$ è la relazione che intercorre tra una chiave primaria e una esterna

per ogni n-upla $r$ dell'istanza $R$ esiste una n-upla $s$ dell'istanza di $S$ (riferita da $r$) 


### Esercizi


> [!QUOTE] 
> Definire uno schema relazionale per organizzare le informazioni di un’azienda che ha impiegati (ognuno con codice fiscale, cognome, nome e data di nascita), filiali (con codice, sede e direttore, che è un impiegato). Ogni lavoratore lavora presso una filiale. Indicare le chiavi e i vincoli di integrità referenziale dello schema. Mostrare un’istanza della base di dati e verificare che soddisfa i vincoli.

```
Impiegati (CF (pk), nome, cognome, data_di_nascita, filiale (fk))
Filiali (Cod (pk), sede, direttore (FK))
```

Da fare per casa:
Un albero genealogico rappresenta, in forma grafica, la struttura di una famiglia (o più famiglie, quando è ben articolato). Mostrare come si possa rappresentare, in una base di dati relazionale, un albero genealogico, cominciando eventualmente da una struttura semplificata, in cui si rappresentano solo le discendenze in linea maschile (cioè i figli vengono rappresentati solo per i componenti di sesso maschile) oppure solo quelle in linea femminile.

---
# Algebra relazione

l'algebra relazione consiste in un set di operatori che: 
- Sono definiti sulle relazioni
- Producono come risultato una relazione

Questi operatori **primitivi** sono:
- Ridenominazione
- Unione
- Differenza
- Proiezione
- Restrizione
- Prodotto

### Ridenominazione
Che usa come simbolo: $\delta$ 
ES: $\delta Matricola \leftarrow CodiceStudente (STUDENTE)$ 
Il nome della colonna Matricola della tabella studente diventa CodiceStudente

### Unione, differenza e intersezione

Le relazione sono degli insiemi di n-uple, se abbiamo molteplici insiemi omogenei possiamo applicare queste 3 operatori:
![[Pasted image 20251003114423.png]]
**Unione**
![[Pasted image 20251003114505.png]]
**Intersezione**
![[Pasted image 20251003114518.png]]
**Differenza**
![[Pasted image 20251003114533.png]]
Questi operatori si posso anche concatenare
![[Pasted image 20251003114918.png]]
### Proiezione
Produce un sottoinsieme degli attributi dell'operando 
Sia $R$ una relazione e siano $A_1, A_2, ... A_n$ alcuni suoi attributi allora:
$$\pi_{A_1, A_2, ... A_n}(R) = \{t[A_1, A_2, ... A_n]t \in R\}$$
![[Pasted image 20251003115337.png]]

### Selezione
Produce un risultato con lo stesso schema dell'operando iniziale ma con un sottoinsieme di ennuple
Data $\lambda$ una formula proposizionale e dato $R$ una relazione allora si ha che:
$$\sigma_\lambda(R) = \{t|t\in R ∧ \lambda(t) = \text{TRUE}\}$$ ![[Pasted image 20251003115657.png]]
### Prodotto cartesiano
Date due relazione $R$ e $S$ con $R ∩ S = \text{insieme vuoto}$ 
Allora si pone:
$$R \times S = \{tu| t \in R ∧ u \in S\}$$ ![[Pasted image 20251003121235.png]]
### JOIN
Permette di combinare tuple da relazioni diverse basandosi sui valori degli attributi, sono principalmente di due tipi:
- **Natural JOIN**
  Sia $R$ con attributi $XY$ ed $S$ con attributi $YZ$ allora $R⋈S$ è una relazione $XYZ$ quindi: $$R⋈S = \{t|t[XY] \in R \text{ e } t[YZ] \in S\}$$
  cioè: le ennuple del risultato sono ottenute combinando le ennuple di $R$ e $S$ che hanno gli stessi valori negli attributi con lo stesso nome
  ![[Pasted image 20251003122038.png]]
- **Theta JOIN**
  Viene specificato un predicato per la selezione delle ennuple, definito in questo modo:
  $$R⋈_F S = \sigma_F(R\times S)$$ Nel caso in cui è una congiunzione di uguaglianze si parla di **equi-JOIN** 
  ![[Pasted image 20251003123448.png]]

//TODO inserire le dimostrazioni che sia natural che equi join sono operatori derivati

### Query
Una query è una funzione da una istanza di una database (insiemi di relazioni) ad una relazione